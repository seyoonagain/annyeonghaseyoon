---
title: 브라우저 저장소 비교
date: 2025-06-04
tags: ['Login']
---

지난 번 포스팅을 통해 로그인의 흐름과 함께 세션 기반 인증과 토큰 기반 인증에 대해 다뤄보았다.  
오늘은 토큰 기반 인증에서 토큰을 저장하기 위해 사용되는 브라우저 저장소에 대해 정리해보려고 한다.

브라우저에서 토큰을 저장할 수 있는 방법은 대표적으로 세 가지가 있다.

- 쿠키 (Cookie)
- 로컬 스토리지 (LocalStorage)
- 세션 스토리지 (SessionStorage)

각 저장소는 동작 방식과 보안 특성이 다르기 때문에, 사용 목적과 상황에 따라 적절한 선택이 필요하다.  
이번 포스팅에서 세 가지 브라우저 저장소에 대해 알아보자.

## 쿠키

쿠키는 최대 크기 4096 bytes의 작은 텍스트 데이터로, 주로 세션 ID나 인증 토큰 등을 저장할 때 사용된다.

---

### 쿠키 생성 위치

- 서버: `Set-Cookie` 헤더를 통해 설정 가능

  ```http
  Set-Cookie: token=abc; Path=/user;
  ```

- 클라이언트: JavaScript(document.cookie)를 통해 설정 가능  
  (단, `HttpOnly` 쿠키는 JavaScript로 설정 불가)

---

### 특징

- 자동 전송  
  브라우저는 쿠키의 `Domain`, `Path`, `SameSite`, `Secure` 조건이 일치하고,  
  요청 방식과 도메인이 허용되는 경우에 한해 요청 헤더에 자동으로 포함시켜 서버로 전송한다.

- 도메인/경로 지정  
  쿠키는 설정된 도메인과 경로에 일치하는 요청에만 포함된다.  
  이를 통해 특정 도메인/경로에 대한 요청에만 쿠키가 전송되도록 제한할 수 있다.

- 만료 기간 설정 가능  
  `Expires` 또는 `Max-Age` 옵션을 통해 유효 기간을 설정할 수 있다.

- 용량 및 개수 제한  
  쿠키 하나 당 4096 bytes로 제한되며, 브라우저마다 다르지만 하나의 도메인에 약 20~50개의 쿠키 개수 제한이 있다.

- CSRF 공격에 취약  
  자동 전송 특성으로 공격자가 사용자의 인증 정보를 포함한 요청을 보낼 수 있다.  
  → `SameSite` 속성으로 방어 가능

- 네트워크 비용 증가  
  모든 요청에 쿠키가 포함되기 때문에, 큰 쿠키를 많이 사용할수록 성능에 영향을 줄 수 있다.

---

### 보안 속성

- `HttpOnly`  
  JavaScript에서 접근 불가하도록 설정한다.  
  XSS 공격에 대한 방어 수단으로 사용된다.

- `Secure`  
  HTTPS 환경에서만 쿠키 전송하도록 설정한다.

- `SameSite`  
  CSRF 방어를 목적으로 하며, 세 가지 설정 방법이 있다.

  - `Strict`: 다른 도메인에서 유입된 모든 요청에 대해 쿠키를 전송하지 않음
  - `Lax`: 크로스 사이트 요청 중 GET 방식에 대해서만 쿠키를 전송하며, POST 등 다른 방식에는 전송하지 않음
  - `None`: 모든 요청에 쿠키 전송 허용 (`Secure` 설정 필수)

## 로컬 스토리지 vs. 세션 스토리지

**로컬 스토리지**와 **세션 스토리지**는 모두 브라우저에서 제공하는 클라이언트 측 저장소로,  
JavaScript를 통해 데이터 저장 및 접근이 가능하다.

---

### 공통점

- 브라우저에 저장  
  서버가 아닌 클라이언트 로컬에 데이터를 저장한다.

- 같은 도메인 내에서만 접근 가능  
  동일 프로토콜 + 도메인 + 포트에 한해 접근이 허용된다.

- JavaScript로 접근 가능  
  `setItem`, `getItem`, `removeItem`등의 메서드를 통해 데이터 저장/조회/삭제가 가능하다.

  ```js
  // 로컬 스토리지
  localStorage.setItem('theme', 'dark');
  const theme = localStorage.getItem('theme');
  localStorage.removeItem('theme');

  // 세션 스토리지
  sessionStorage.setItem('temp', '123');
  const temp = sessionStorage.getItem('temp');
  sessionStorage.removeItem('temp');
  ```

- 서버 전송 여부  
  쿠키와 달리, 저장된 데이터는 자동으로 서버에 전송되지 않는다.  
  필요 시, JavaScript로 직접 전송해야 한다.

- XSS 공격에 취약  
  JavaScript로 접근 가능한 특성 때문에, XSS 공격 시 데이터가 노출될 수 있다.

- 용량 제한
  브라우저마다 다르지만 약 5~10MB의 데이터를 저장할 수 있다.

---

### 차이점

- 데이터 유지 기간

  - 로컬 스토리지: 사용자가 삭제하기 전까지 영구적으로 저장
  - 세션 스토리지: 탭/창을 닫으면 삭제

- 탭/창 간 공유

  - 로컬 스토리지: 같은 도메인이라면 모든 탭/창에서 공유
  - 세션 스토리지: 탭/창 간 공유되지 않음

- 사용 목적

  - 로컬 스토리지: 장기적 데이터 보존 (예: 사용자 설정, 테마 등)
  - 세션 스토리지: 일시적 데이터 저장 (예: 입력값 임시 저장 등)

---

### 보안 주의사항

로컬 스토리지와 세션 스토리지는 XSS 공격에 안전하지 않으므로,  
민감한 정보를 저장하지 않는 것이 원칙이다.

## 정리

### 보안 이슈 요약

|  저장소 유형  |    XSS 취약성     | CSRF 취약성 |                    방어 방법                     |
| :-----------: | :---------------: | :---------: | :----------------------------------------------: |
|     쿠키      | 낮음 (`HttpOnly`) |     ⭕️      |           `SameSite`, `HttpOnly` 설정            |
| 로컬 스토리지 |        ⭕️         |     ❌      | XSS 방어 (CSP, 입력 필터링, DOM Sanitization 등) |
| 세션 스토리지 |        ⭕️         |     ❌      | XSS 방어 (CSP, 입력 필터링, DOM Sanitization 등) |

> ⚠️ **주의**  
> 로컬/세션 스토리지는 JavaScript로 접근 가능하므로, **절대 민감한 정보를 저장하지 말 것!**

### 전체 특징 요약

|           |                    쿠키                    |     로컬 스토리지     | 세션 스토리지  |
| :-------: | :----------------------------------------: | :-------------------: | :------------: |
| 저장 위치 |              클라이언트/서버               |      클라이언트       |   클라이언트   |
| 전송 방식 |               자동 전송 가능               |    자동 전송 안됨     | 자동 전송 안됨 |
| 만료 시점 |      `Expires`/`Max-Age`로 지정 가능       | 삭제 전까지 만료 안됨 |   탭 종료 시   |
| 접근 방식 |      제한적(`HttpOnly` 시 접근 불가)       |      JavaScript       |   JavaScript   |
|   보안    | XSS 대응(`HttpOnly`)/CSRF 대응(`SameSite`) |       XSS 취약        |    XSS 취약    |
| 용량 제한 |                   약 4KB                   |       약 5~10MB       |   약 5~10MB    |

각 브라우저 저장소는 보안, 전송 방식, 수명 등에서 분명한 차이를 가지므로,  
**데이터의 중요도와 사용 목적에 따라 적절히 선택하는 것이 중요**하다.  
특히, 민감한 정보는 반드시 `HttpOnly` 쿠키에 저장하고,  
기타 설정 정보나 임시 데이터는 로컬 또는 세션 스토리지를 상황에 맞게 활용하자.
